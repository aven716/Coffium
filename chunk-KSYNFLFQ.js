import{$a as $,A as m,B as S,C as k,Da as B,E as T,F as E,G as j,Ka as L,M as H,N as R,Na as N,Oa as Q,P as z,S as A,X as F,Ya as V,Za as W,ab as q,bb as X,db as Y,e as b,f as C,fb as G,gb as J,i as M,ib as K,j as s,jb as Z,k as O,l as p,lb as ee,m as P,n as f,nb as te,ob as ne,p as d,pb as ie,q as r,r as a,s as h,t as w,u,v as _,w as v,wa as D,x as y,z as I,za as U}from"./chunk-KZXXQ5EB.js";import{e as x}from"./chunk-JHI3MBHO.js";var oe=["*"];function re(i,o){if(i&1){let c=w();r(0,"ion-item",14),u("click",function(){let e=b(c).$implicit,t=_(2);return C(t.openProduct(e))}),r(1,"ion-thumbnail",2),h(2,"img",15),a(),r(3,"ion-label")(4,"h2"),m(5),a(),r(6,"p"),m(7),a()()()}if(i&2){let c=o.$implicit;s(2),d("src","https://add2mart.shop/ionic/coffium/api/images/products/"+c.picture,M),s(3),S(c.name),s(2),k("\u20B1",c.price)}}function ae(i,o){if(i&1&&(r(0,"div",12)(1,"ion-list"),f(2,re,8,3,"ion-item",13),a()()),i&2){let c=_();s(2),d("ngForOf",c.searchResults)}}function se(i,o){i&1&&h(0,"ion-spinner")}var be=(()=>{let o=class o{constructor(n,e,t,g){this.http=n,this.menu=e,this.router=t,this.toastCtrl=g,this.showSearchbar=!0,this.showIcons=!0,this.toggleMenu=new O,this.user={user_id:0,first_name:"",last_name:"",email:"",profile_image:"",address:""},this.searchQuery="",this.searchResults=[],this.searching=!1,this.searchExpanded=!1}ngOnInit(){let n=localStorage.getItem("user_id");n&&this.loadUserData(n)}toggleSidebar(){console.log("Header click - emitting toggleMenu"),this.toggleMenu.emit()}loadUserData(n){this.http.get(`https://add2mart.shop/ionic/coffium/api/get_user.php?user_id=${n}`).subscribe(e=>{e.success&&e.user&&(this.user={user_id:e.user.id||0,first_name:e.user.first_name||"",last_name:e.user.last_name||"",email:e.user.email||"",address:e.user.address||"",profile_image:e.user.profile_image?`https://add2mart.shop/ionic/coffium/api/images/profile_picture/${e.user.profile_image}`:"assets/images/default-profile.png"})},e=>console.error("User fetch error:",e))}showToast(n,e){return x(this,null,function*(){yield(yield this.toastCtrl.create({message:n,duration:1500,color:e})).present()})}onSearchChange(n){let e=n.detail.value.trim();if(this.searchQuery=e,e.length<2){this.searchResults=[];return}this.searching=!0,this.http.get(`https://add2mart.shop/ionic/coffium/api/search_products.php?query=${encodeURIComponent(e)}`).subscribe(t=>{this.searching=!1,t.success&&t.products?this.searchResults=t.products:(this.searchResults=[],this.showToast("No products found","medium"))},t=>{console.error("Search error:",t),this.searching=!1,this.showToast("Search failed","danger")})}openProduct(n){this.router.navigate(["/product",n.product_id])}goToFavorites(){this.router.navigate(["/favorites"])}goToCart(){this.router.navigate(["/cart"])}toggleSearch(){this.searchExpanded=!this.searchExpanded}};o.\u0275fac=function(e){return new(e||o)(p(A),p(te),p(F),p(ne))},o.\u0275cmp=P({type:o,selectors:[["app-header"]],inputs:{showSearchbar:"showSearchbar",showIcons:"showIcons"},outputs:{toggleMenu:"toggleMenu"},ngContentSelectors:oe,decls:17,vars:5,consts:[[1,"header-toolbar"],[1,"header-flex"],["slot","start"],[1,"logo"],["fill","clear","routerLink","/home","detail","false"],[1,"search-container"],[1,"collapsible-search"],["placeholder","Search...",3,"ngModelChange","ionInput","ngModel"],["fill","clear",3,"click"],["name","search"],["class","search-results",4,"ngIf"],[4,"ngIf"],[1,"search-results"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"],[3,"src"]],template:function(e,t){e&1&&(v(),r(0,"ion-header")(1,"ion-toolbar",0)(2,"div",1)(3,"ion-buttons",2),h(4,"ion-menu-button"),a(),r(5,"div",3)(6,"ion-button",4)(7,"h3"),m(8,"Coffium"),a()()(),r(9,"div",5)(10,"div",6)(11,"ion-searchbar",7),j("ngModelChange",function(l){return E(t.searchQuery,l)||(t.searchQuery=l),l}),u("ionInput",function(l){return t.onSearchChange(l)}),a()(),r(12,"ion-button",8),u("click",function(){return t.toggleSearch()}),h(13,"ion-icon",9),a()()()(),f(14,ae,3,1,"div",10)(15,se,1,0,"ion-spinner",11),y(16),a()),e&2&&(s(9),I("expanded",t.searchExpanded),s(2),T("ngModel",t.searchQuery),s(3),d("ngIf",t.searchResults.length>0),s(),d("ngIf",t.searching))},dependencies:[ie,N,Q,V,W,$,q,X,Y,G,J,K,Z,L,ee,z,H,R,B,D,U],styles:['@charset "UTF-8";ion-toolbar.header-toolbar[_ngcontent-%COMP%]{--min-height: 56px;padding:0 10px;display:flex;align-items:center;justify-content:center;--background: linear-gradient(to bottom, #35593E, #2D4739)}.header-flex[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%}.header-flex[_ngcontent-%COMP%]   ion-buttons[_ngcontent-%COMP%]{display:flex;align-items:center;margin-right:8px;color:#fff}.header-flex[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{flex:1;--height: 40px;--border-radius: 8px;--background: #3e443d;--box-shadow: 0 3px 8px rgba(0, 0, 0, .08);margin:0;color:gray;align-self:center}ion-searchbar[_ngcontent-%COMP%]{margin:10px 15px;border-radius:10px;--box-shadow: 0 3px 8px rgba(0, 0, 0, .08);--placeholder-color: #777;--color: #13442e;z-index:10}.search-wrapper[_ngcontent-%COMP%]{position:relative;display:block;width:100%;padding:0 15px;height:fit-content}.search-results[_ngcontent-%COMP%]{position:absolute;top:60px;left:15px;right:15px;background:#000;border-radius:10px;box-shadow:0 6px 15px #00000026;z-index:99;max-height:300px;overflow-y:auto;border:1px solid rgba(19,68,46,.2);animation:_ngcontent-%COMP%_fadeIn .2s ease-in-out}.search-results[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: transparent;--inner-padding-end: 10px;transition:background-color .2s ease-in-out}.search-results[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:hover{--background: rgba(19, 68, 46, .05)}.search-results[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:8px;object-fit:cover}.search-results[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:.95rem;color:#13442e;margin:0}.search-results[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85rem;color:#555;margin:2px 0 0}ion-spinner[_ngcontent-%COMP%]{display:block;margin:10px auto;color:#13442e}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}.search-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;width:100%;padding:0}ion-searchbar[_ngcontent-%COMP%]{width:90%;max-width:500px;border-radius:10px;--box-shadow: 0 3px 8px rgba(0, 0, 0, .08);--placeholder-color: #777;--color: #13442e;z-index:10}.search-results[_ngcontent-%COMP%]{top:60px;left:50%;transform:translate(-50%);width:90%;max-width:500px;background:#000;border-radius:10px;box-shadow:0 6px 15px #00000026;z-index:99;max-height:300px;overflow-y:auto;border:1px solid rgba(19,68,46,.2);animation:_ngcontent-%COMP%_fadeIn .2s ease-in-out}.user-bar[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{width:45px;height:45px;border-radius:50%;overflow:hidden}.user-bar[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;display:block}.header-flex[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{flex:none;width:70%;max-width:400px;--height: 36px;height:36px;color:#fff;margin:0;padding:0;align-self:center;--border-radius: 8px;--background: #4c914f41;--box-shadow: 0 3px 8px rgba(0, 0, 0, .08)}.header-flex[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]::part(container){padding-top:0;padding-bottom:0;display:flex;align-items:center}ion-toolbar.header-toolbar[_ngcontent-%COMP%]::part(container), ion-toolbar.header-toolbar[_ngcontent-%COMP%]::part(content){display:flex;align-items:center}.header-flex[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;align-items:center;margin-right:10px}.header-flex[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff;font-weight:600;font-size:1.1rem;margin:0}.search-container[_ngcontent-%COMP%]{display:flex;align-items:center;position:absolute;right:10px;transition:all .3s ease}.collapsible-search[_ngcontent-%COMP%]{width:0;opacity:0;overflow:hidden;transform:scaleX(0);transform-origin:right center;transition:transform .3s ease,opacity .3s ease,width .3s ease}.search-container.expanded[_ngcontent-%COMP%]   .collapsible-search[_ngcontent-%COMP%]{width:180px;opacity:1;transform:scaleX(1)}.search-container[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--color: white;margin-left:6px}.collapsible-search[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{--background: #fff;--color: #13442e;--border-radius: 8px;height:36px;width:100%;transition:all .3s ease}ion-menu-button[_ngcontent-%COMP%]{color:#fff}']});let i=o;return i})();export{be as a};
